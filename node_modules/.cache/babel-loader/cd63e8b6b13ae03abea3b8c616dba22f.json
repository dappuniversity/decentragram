{"ast":null,"code":"'use strict';\n\nvar nodeify = require('../nodeify');\n\nvar crypto = require('../webcrypto');\n\nvar lengths = require('./lengths');\n\nvar hashTypes = {\n  SHA1: 'SHA-1',\n  SHA256: 'SHA-256',\n  SHA512: 'SHA-512'\n};\n\nvar sign = function sign(key, data, cb) {\n  nodeify(crypto.subtle.sign({\n    name: 'HMAC'\n  }, key, data).then(function (raw) {\n    return Buffer.from(raw);\n  }), cb);\n};\n\nexports.create = function (hashType, secret, callback) {\n  var hash = hashTypes[hashType];\n  nodeify(crypto.subtle.importKey('raw', secret, {\n    name: 'HMAC',\n    hash: {\n      name: hash\n    }\n  }, false, ['sign']).then(function (key) {\n    return {\n      digest: function digest(data, cb) {\n        sign(key, data, cb);\n      },\n      length: lengths[hashType]\n    };\n  }), callback);\n};","map":null,"metadata":{},"sourceType":"script"}