{"ast":null,"code":"var through = require('through2');\n\nvar split = require('split2');\n\nvar EOL = require('os').EOL;\n\nvar stringify = require('json-stringify-safe');\n\nmodule.exports = parse;\nmodule.exports.serialize = module.exports.stringify = serialize;\nmodule.exports.parse = parse;\n\nfunction parse(opts) {\n  opts = opts || {};\n  opts.strict = opts.strict !== false;\n\n  function parseRow(row) {\n    try {\n      if (row) return JSON.parse(row);\n    } catch (e) {\n      if (opts.strict) {\n        this.emit('error', new Error('Could not parse row ' + row.slice(0, 50) + '...'));\n      }\n    }\n  }\n\n  return split(parseRow, opts);\n}\n\nfunction serialize(opts) {\n  return through.obj(opts, function (obj, enc, cb) {\n    cb(null, stringify(obj) + EOL);\n  });\n}","map":null,"metadata":{},"sourceType":"script"}