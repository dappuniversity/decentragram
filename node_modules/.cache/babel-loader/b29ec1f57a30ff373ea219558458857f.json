{"ast":null,"code":"/** PROMISIFY CALLBACK-STYLE FUNCTIONS TO ES6 PROMISES\r\n*\r\n* EXAMPLE:\r\n* const fn = promisify( (callback) => callback(null, \"Hello world!\") );\r\n* fn((err, str) => console.log(str));\r\n* fn().then((str) => console.log(str));\r\n* //Both functions, will log 'Hello world!'\r\n*\r\n* Note: The function you pass, may have any arguments you want, but the latest\r\n* have to be the callback, which you will call with: next(err, value)\r\n*\r\n* @param method: Function/Array/Map = The function(s) to promisify\r\n* @param options: Map =\r\n*  \"context\" (default is function): The context which to apply the called function\r\n*  \"replace\" (default is falsy): When passed an array/map, if to replace the original object\r\n*\r\n* @return: A promise if passed a function, otherwise the object with the promises\r\n*\r\n* @license: MIT\r\n* @version: 1.0.3\r\n* @author: Manuel Di Iorio\r\n**/\nvar createCallback = function createCallback(method, context) {\n  return function () {\n    var args = Array.prototype.slice.call(arguments);\n    var lastIndex = args.length - 1;\n    var lastArg = args && args.length > 0 ? args[lastIndex] : null;\n    var cb = typeof lastArg === 'function' ? lastArg : null;\n\n    if (cb) {\n      return method.apply(context, args);\n    }\n\n    return new Promise(function (resolve, reject) {\n      args.push(function (err, val) {\n        if (err) return reject(err);\n        resolve(val);\n      });\n      method.apply(context, args);\n    });\n  };\n};\n\nif (typeof module === \"undefined\") module = {}; // Browserify this module\n\nmodule.exports = function (methods, options) {\n  options = options || {};\n  var type = Object.prototype.toString.call(methods);\n\n  if (type === \"[object Object]\" || type === \"[object Array]\") {\n    var obj = options.replace ? methods : {};\n\n    for (var key in methods) {\n      if (methods.hasOwnProperty(key)) obj[key] = createCallback(methods[key]);\n    }\n\n    return obj;\n  }\n\n  return createCallback(methods, options.context || methods);\n}; // Browserify this module\n\n\nif (typeof exports === \"undefined\") {\n  this[\"promisify\"] = module.exports;\n}","map":null,"metadata":{},"sourceType":"script"}