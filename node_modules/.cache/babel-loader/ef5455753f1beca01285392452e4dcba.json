{"ast":null,"code":"var Transform = require('readable-stream').Transform,\n    inherits = require('inherits');\n\nfunction DestroyableTransform(opts) {\n  Transform.call(this, opts);\n  this._destroyed = false;\n}\n\ninherits(DestroyableTransform, Transform);\n\nDestroyableTransform.prototype.destroy = function (err) {\n  if (this._destroyed) return;\n  this._destroyed = true;\n  var self = this;\n  process.nextTick(function () {\n    if (err) self.emit('error', err);\n    self.emit('close');\n  });\n}; // a noop _transform function\n\n\nfunction noop(chunk, enc, callback) {\n  callback(null, chunk);\n} // create a new export function, used by both the main export and\n// the .ctor export, contains common logic for dealing with arguments\n\n\nfunction through2(construct) {\n  return function (options, transform, flush) {\n    if (typeof options == 'function') {\n      flush = transform;\n      transform = options;\n      options = {};\n    }\n\n    if (typeof transform != 'function') transform = noop;\n    if (typeof flush != 'function') flush = null;\n    return construct(options, transform, flush);\n  };\n} // main export, just make me a transform stream!\n\n\nmodule.exports = through2(function (options, transform, flush) {\n  var t2 = new DestroyableTransform(options);\n  t2._transform = transform;\n  if (flush) t2._flush = flush;\n  return t2;\n}); // make me a reusable prototype that I can `new`, or implicitly `new`\n// with a constructor call\n\nmodule.exports.ctor = through2(function (options, transform, flush) {\n  function Through2(override) {\n    if (!(this instanceof Through2)) return new Through2(override);\n    this.options = Object.assign({}, options, override);\n    DestroyableTransform.call(this, this.options);\n  }\n\n  inherits(Through2, DestroyableTransform);\n  Through2.prototype._transform = transform;\n  if (flush) Through2.prototype._flush = flush;\n  return Through2;\n});\nmodule.exports.obj = through2(function (options, transform, flush) {\n  var t2 = new DestroyableTransform(Object.assign({\n    objectMode: true,\n    highWaterMark: 16\n  }, options));\n  t2._transform = transform;\n  if (flush) t2._flush = flush;\n  return t2;\n});","map":null,"metadata":{},"sourceType":"script"}