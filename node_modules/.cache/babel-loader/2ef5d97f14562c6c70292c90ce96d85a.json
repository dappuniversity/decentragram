{"ast":null,"code":"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('lodash/isString'), require('lodash/isArray'), require('lodash/isObject'), require('lodash/isNumber'), require('web3-utils'), require('web3-eth-iban')) : typeof define === 'function' && define.amd ? define(['exports', 'lodash/isString', 'lodash/isArray', 'lodash/isObject', 'lodash/isNumber', 'web3-utils', 'web3-eth-iban'], factory) : (global = global || self, factory(global.Web3CoreHelpers = {}, global.isString, global.isArray, global.isObject, global.isNumber, global.Utils, global.web3EthIban));\n})(this, function (exports, isString, isArray, isObject, isNumber, Utils, web3EthIban) {\n  'use strict';\n\n  isString = isString && isString.hasOwnProperty('default') ? isString['default'] : isString;\n  isArray = isArray && isArray.hasOwnProperty('default') ? isArray['default'] : isArray;\n  isObject = isObject && isObject.hasOwnProperty('default') ? isObject['default'] : isObject;\n  isNumber = isNumber && isNumber.hasOwnProperty('default') ? isNumber['default'] : isNumber;\n\n  var outputBigNumberFormatter = function outputBigNumberFormatter(number) {\n    return Utils.toBN(number).toString(10);\n  };\n\n  var isPredefinedBlockNumber = function isPredefinedBlockNumber(blockNumber) {\n    return blockNumber === 'latest' || blockNumber === 'pending' || blockNumber === 'earliest';\n  };\n\n  var inputDefaultBlockNumberFormatter = function inputDefaultBlockNumberFormatter(blockNumber, moduleInstance) {\n    if (blockNumber === undefined || blockNumber === null) {\n      return moduleInstance.defaultBlock;\n    }\n\n    return inputBlockNumberFormatter(blockNumber);\n  };\n\n  var inputBlockNumberFormatter = function inputBlockNumberFormatter(blockNumber) {\n    if (blockNumber === undefined || blockNumber === null || isPredefinedBlockNumber(blockNumber)) {\n      return blockNumber;\n    }\n\n    if (Utils.isHexStrict(blockNumber)) {\n      if (isString(blockNumber)) {\n        return blockNumber.toLowerCase();\n      }\n\n      return blockNumber;\n    }\n\n    return Utils.numberToHex(blockNumber);\n  };\n\n  var txInputFormatter = function txInputFormatter(txObject) {\n    if (txObject.to) {\n      txObject.to = inputAddressFormatter(txObject.to);\n    }\n\n    if (txObject.data && txObject.input) {\n      throw new Error('You can\\'t have \"data\" and \"input\" as properties of transactions at the same time, please use either \"data\" or \"input\" instead.');\n    }\n\n    if (!txObject.data && txObject.input) {\n      txObject.data = txObject.input;\n      delete txObject.input;\n    }\n\n    if (txObject.data && !Utils.isHex(txObject.data)) {\n      throw new Error('The data field must be HEX encoded data.');\n    }\n\n    if (txObject.gas || txObject.gasLimit) {\n      txObject.gas = txObject.gas || txObject.gasLimit;\n    }\n\n    ['gasPrice', 'gas', 'value', 'nonce'].filter(function (key) {\n      return txObject[key] !== undefined;\n    }).forEach(function (key) {\n      txObject[key] = Utils.numberToHex(txObject[key]);\n    });\n    return txObject;\n  };\n\n  var inputCallFormatter = function inputCallFormatter(txObject, moduleInstance) {\n    txObject = txInputFormatter(txObject);\n    var from = moduleInstance.defaultAccount;\n\n    if (txObject.from) {\n      from = txObject.from;\n    }\n\n    if (from) {\n      txObject.from = inputAddressFormatter(from);\n    }\n\n    return txObject;\n  };\n\n  var inputTransactionFormatter = function inputTransactionFormatter(txObject, moduleInstance) {\n    txObject = txInputFormatter(txObject);\n\n    if (!isNumber(txObject.from) && !isObject(txObject.from)) {\n      if (!txObject.from) {\n        txObject.from = moduleInstance.defaultAccount;\n      }\n\n      if (!txObject.from && !isNumber(txObject.from)) {\n        throw new Error('The send transactions \"from\" field must be defined!');\n      }\n\n      txObject.from = inputAddressFormatter(txObject.from);\n    }\n\n    return txObject;\n  };\n\n  var inputSignFormatter = function inputSignFormatter(data) {\n    return Utils.isHexStrict(data) ? data : Utils.utf8ToHex(data);\n  };\n\n  var outputTransactionFormatter = function outputTransactionFormatter(receipt) {\n    if (receipt.blockNumber !== null) {\n      receipt.blockNumber = Utils.hexToNumber(receipt.blockNumber);\n    }\n\n    if (receipt.transactionIndex !== null) {\n      receipt.transactionIndex = Utils.hexToNumber(receipt.transactionIndex);\n    }\n\n    if (receipt.gasPrice) {\n      receipt.gasPrice = outputBigNumberFormatter(receipt.gasPrice);\n    }\n\n    if (receipt.value) {\n      receipt.value = outputBigNumberFormatter(receipt.value);\n    }\n\n    receipt.nonce = Utils.hexToNumber(receipt.nonce);\n    receipt.gas = Utils.hexToNumber(receipt.gas);\n\n    if (receipt.to && Utils.isAddress(receipt.to)) {\n      receipt.to = Utils.toChecksumAddress(receipt.to);\n    } else {\n      receipt.to = null;\n    }\n\n    if (receipt.from) {\n      receipt.from = Utils.toChecksumAddress(receipt.from);\n    }\n\n    return receipt;\n  };\n\n  var outputTransactionReceiptFormatter = function outputTransactionReceiptFormatter(receipt) {\n    if (receipt.blockNumber !== null) {\n      receipt.blockNumber = Utils.hexToNumber(receipt.blockNumber);\n    }\n\n    if (receipt.transactionIndex !== null) {\n      receipt.transactionIndex = Utils.hexToNumber(receipt.transactionIndex);\n    }\n\n    receipt.cumulativeGasUsed = Utils.hexToNumber(receipt.cumulativeGasUsed);\n    receipt.gasUsed = Utils.hexToNumber(receipt.gasUsed);\n\n    if (isArray(receipt.logs)) {\n      receipt.logs = receipt.logs.map(outputLogFormatter);\n    }\n\n    if (receipt.contractAddress) {\n      receipt.contractAddress = Utils.toChecksumAddress(receipt.contractAddress);\n    }\n\n    if (typeof receipt.status !== 'undefined' && receipt.status !== null) {\n      receipt.status = Boolean(parseInt(receipt.status));\n    } else {\n      receipt.status = true;\n    }\n\n    return receipt;\n  };\n\n  var outputBlockFormatter = function outputBlockFormatter(block) {\n    block.gasLimit = Utils.hexToNumber(block.gasLimit);\n    block.gasUsed = Utils.hexToNumber(block.gasUsed);\n    block.size = Utils.hexToNumber(block.size);\n    var timestamp = Utils.toBN(block.timestamp);\n\n    if (timestamp.bitLength() <= 53) {\n      block.timestamp = timestamp.toNumber();\n    } else {\n      block.timestamp = timestamp.toString(10);\n    }\n\n    if (block.number !== null) {\n      block.number = Utils.hexToNumber(block.number);\n    }\n\n    if (block.difficulty) {\n      block.difficulty = outputBigNumberFormatter(block.difficulty);\n    }\n\n    if (block.totalDifficulty) {\n      block.totalDifficulty = outputBigNumberFormatter(block.totalDifficulty);\n    }\n\n    if (isArray(block.transactions)) {\n      block.transactions.forEach(function (item) {\n        if (!isString(item)) return outputTransactionFormatter(item);\n      });\n    }\n\n    if (block.miner) {\n      block.miner = Utils.toChecksumAddress(block.miner);\n    }\n\n    return block;\n  };\n\n  var inputLogFormatter = function inputLogFormatter(options) {\n    var toTopic = function toTopic(value) {\n      if (value === null || typeof value === 'undefined') {\n        return null;\n      }\n\n      value = String(value);\n\n      if (value.indexOf('0x') === 0) {\n        return value;\n      }\n\n      return Utils.fromUtf8(value);\n    };\n\n    if (options.fromBlock) {\n      options.fromBlock = inputBlockNumberFormatter(options.fromBlock);\n    }\n\n    if (options.toBlock) {\n      options.toBlock = inputBlockNumberFormatter(options.toBlock);\n    }\n\n    options.topics = options.topics || [];\n    options.topics = options.topics.map(function (topic) {\n      return isArray(topic) ? topic.map(toTopic) : toTopic(topic);\n    });\n    toTopic = null;\n\n    if (options.address) {\n      if (isArray(options.address)) {\n        options.address = options.address.map(function (addr) {\n          return inputAddressFormatter(addr);\n        });\n      } else {\n        options.address = inputAddressFormatter(options.address);\n      }\n    }\n\n    return options;\n  };\n\n  var outputLogFormatter = function outputLogFormatter(log) {\n    if (typeof log.blockHash === 'string' && typeof log.transactionHash === 'string' && typeof log.logIndex === 'string') {\n      var shaId = Utils.keccak256(log.blockHash.replace('0x', '') + log.transactionHash.replace('0x', '') + log.logIndex.replace('0x', ''));\n      shaId.replace('0x', '').substr(0, 8);\n      log.id = \"log_\".concat(shaId);\n    } else if (!log.id) {\n      log.id = null;\n    }\n\n    if (log.blockNumber !== null) {\n      log.blockNumber = Utils.hexToNumber(log.blockNumber);\n    }\n\n    if (log.transactionIndex !== null) {\n      log.transactionIndex = Utils.hexToNumber(log.transactionIndex);\n    }\n\n    if (log.logIndex !== null) {\n      log.logIndex = Utils.hexToNumber(log.logIndex);\n    }\n\n    if (log.address) {\n      log.address = Utils.toChecksumAddress(log.address);\n    }\n\n    return log;\n  };\n\n  var inputPostFormatter = function inputPostFormatter(post) {\n    if (post.ttl) {\n      post.ttl = Utils.numberToHex(post.ttl);\n    }\n\n    if (post.workToProve) {\n      post.workToProve = Utils.numberToHex(post.workToProve);\n    }\n\n    if (post.priority) {\n      post.priority = Utils.numberToHex(post.priority);\n    }\n\n    if (!isArray(post.topics)) {\n      post.topics = post.topics ? [post.topics] : [];\n    }\n\n    post.topics = post.topics.map(function (topic) {\n      return topic.indexOf('0x') === 0 ? topic : Utils.fromUtf8(topic);\n    });\n    return post;\n  };\n\n  var outputPostFormatter = function outputPostFormatter(post) {\n    post.expiry = Utils.hexToNumber(post.expiry);\n    post.sent = Utils.hexToNumber(post.sent);\n    post.ttl = Utils.hexToNumber(post.ttl);\n    post.workProved = Utils.hexToNumber(post.workProved);\n\n    if (!post.topics) {\n      post.topics = [];\n    }\n\n    post.topics = post.topics.map(function (topic) {\n      return Utils.toUtf8(topic);\n    });\n    return post;\n  };\n\n  var inputAddressFormatter = function inputAddressFormatter(address) {\n    var iban = new web3EthIban.Iban(address);\n\n    if (iban.isValid() && iban.isDirect()) {\n      return iban.toAddress().toLowerCase();\n    }\n\n    if (Utils.isAddress(address)) {\n      return \"0x\".concat(address.toLowerCase().replace('0x', ''));\n    }\n\n    throw new Error(\"Provided address \\\"\".concat(address, \"\\\" is invalid, the capitalization checksum test failed, or its an indrect IBAN address which can't be converted.\"));\n  };\n\n  var outputSyncingFormatter = function outputSyncingFormatter(result) {\n    result.startingBlock = Utils.hexToNumber(result.startingBlock);\n    result.currentBlock = Utils.hexToNumber(result.currentBlock);\n    result.highestBlock = Utils.hexToNumber(result.highestBlock);\n\n    if (result.knownStates) {\n      result.knownStates = Utils.hexToNumber(result.knownStates);\n      result.pulledStates = Utils.hexToNumber(result.pulledStates);\n    }\n\n    return result;\n  };\n\n  var Formatters =\n  /*#__PURE__*/\n  Object.freeze({\n    outputBigNumberFormatter: outputBigNumberFormatter,\n    isPredefinedBlockNumber: isPredefinedBlockNumber,\n    inputDefaultBlockNumberFormatter: inputDefaultBlockNumberFormatter,\n    inputBlockNumberFormatter: inputBlockNumberFormatter,\n    txInputFormatter: txInputFormatter,\n    inputCallFormatter: inputCallFormatter,\n    inputTransactionFormatter: inputTransactionFormatter,\n    inputSignFormatter: inputSignFormatter,\n    outputTransactionFormatter: outputTransactionFormatter,\n    outputTransactionReceiptFormatter: outputTransactionReceiptFormatter,\n    outputBlockFormatter: outputBlockFormatter,\n    inputLogFormatter: inputLogFormatter,\n    outputLogFormatter: outputLogFormatter,\n    inputPostFormatter: inputPostFormatter,\n    outputPostFormatter: outputPostFormatter,\n    inputAddressFormatter: inputAddressFormatter,\n    outputSyncingFormatter: outputSyncingFormatter\n  });\n  exports.formatters = Formatters;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":null,"metadata":{},"sourceType":"script"}