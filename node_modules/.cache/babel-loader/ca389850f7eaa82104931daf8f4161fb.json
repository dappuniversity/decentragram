{"ast":null,"code":"'use strict';\n\nvar streamToValue = require('./stream-to-value');\n/*\n  Converts a stream to a single JSON value\n*/\n\n\nfunction streamToJsonValue(res, cb) {\n  streamToValue(res, function (err, data) {\n    if (err) {\n      return cb(err);\n    }\n\n    if (!data || data.length === 0) {\n      return cb();\n    } // TODO: check if needed, afaik JSON.parse can parse Buffers\n\n\n    if (Buffer.isBuffer(data)) {\n      data = data.toString();\n    }\n\n    var res;\n\n    try {\n      res = JSON.parse(data);\n    } catch (err) {\n      return cb(new Error(\"Invalid JSON: \".concat(data)));\n    }\n\n    cb(null, res);\n  });\n}\n\nmodule.exports = streamToJsonValue;","map":null,"metadata":{},"sourceType":"script"}