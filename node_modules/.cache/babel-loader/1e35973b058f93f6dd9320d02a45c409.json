{"ast":null,"code":"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@babel/runtime/helpers/classCallCheck'), require('@babel/runtime/helpers/createClass'), require('web3-utils'), require('bn.js')) : typeof define === 'function' && define.amd ? define(['exports', '@babel/runtime/helpers/classCallCheck', '@babel/runtime/helpers/createClass', 'web3-utils', 'bn.js'], factory) : (global = global || self, factory(global.Web3EthIban = {}, global._classCallCheck, global._createClass, global.Utils, global.BigNumber));\n})(this, function (exports, _classCallCheck, _createClass, Utils, BigNumber) {\n  'use strict';\n\n  _classCallCheck = _classCallCheck && _classCallCheck.hasOwnProperty('default') ? _classCallCheck['default'] : _classCallCheck;\n  _createClass = _createClass && _createClass.hasOwnProperty('default') ? _createClass['default'] : _createClass;\n  BigNumber = BigNumber && BigNumber.hasOwnProperty('default') ? BigNumber['default'] : BigNumber;\n\n  var leftPad = function leftPad(string, bytes) {\n    var result = string;\n\n    while (result.length < bytes * 2) {\n      result = \"0\".concat(result);\n    }\n\n    return result;\n  };\n\n  var iso13616Prepare = function iso13616Prepare(iban) {\n    var A = 'A'.charCodeAt(0);\n    var Z = 'Z'.charCodeAt(0);\n    iban = iban.toUpperCase();\n    iban = iban.substr(4) + iban.substr(0, 4);\n    return iban.split('').map(function (n) {\n      var code = n.charCodeAt(0);\n\n      if (code >= A && code <= Z) {\n        return code - A + 10;\n      } else {\n        return n;\n      }\n    }).join('');\n  };\n\n  var module9710 = function module9710(iban) {\n    var remainder = iban;\n    var block;\n\n    while (remainder.length > 2) {\n      block = remainder.slice(0, 9);\n      remainder = parseInt(block, 10) % 97 + remainder.slice(block.length);\n    }\n\n    return parseInt(remainder, 10) % 97;\n  };\n\n  var Iban = function () {\n    function Iban(iban) {\n      _classCallCheck(this, Iban);\n\n      this._iban = iban;\n    }\n\n    _createClass(Iban, [{\n      key: \"isValid\",\n      value: function isValid() {\n        return /^XE\\d{2}(ETH[0-9A-Z]{13}|[0-9A-Z]{30,31})$/.test(this._iban) && module9710(iso13616Prepare(this._iban)) === 1;\n      }\n    }, {\n      key: \"isDirect\",\n      value: function isDirect() {\n        return this._iban.length === 34 || this._iban.length === 35;\n      }\n    }, {\n      key: \"isIndirect\",\n      value: function isIndirect() {\n        return this._iban.length === 20;\n      }\n    }, {\n      key: \"checksum\",\n      value: function checksum() {\n        return this._iban.substr(2, 2);\n      }\n    }, {\n      key: \"institution\",\n      value: function institution() {\n        return this.isIndirect() ? this._iban.substr(7, 4) : '';\n      }\n    }, {\n      key: \"client\",\n      value: function client() {\n        return this.isIndirect() ? this._iban.substr(11) : '';\n      }\n    }, {\n      key: \"toAddress\",\n      value: function toAddress() {\n        if (this.isDirect()) {\n          var base36 = this._iban.substr(4);\n\n          var asBn = new BigNumber(base36, 36);\n          return Utils.toChecksumAddress(asBn.toString(16, 20));\n        }\n\n        return '';\n      }\n    }, {\n      key: \"toString\",\n      value: function toString() {\n        return this._iban;\n      }\n    }], [{\n      key: \"toAddress\",\n      value: function toAddress(iban) {\n        iban = new Iban(iban);\n\n        if (!iban.isDirect()) {\n          throw new Error(\"IBAN is indirect and can't be converted\");\n        }\n\n        return iban.toAddress();\n      }\n    }, {\n      key: \"toIban\",\n      value: function toIban(address) {\n        return Iban.fromAddress(address).toString();\n      }\n    }, {\n      key: \"fromAddress\",\n      value: function fromAddress(address) {\n        if (!Utils.isAddress(address)) {\n          throw new Error(\"Provided address is not a valid address: \".concat(address));\n        }\n\n        address = address.replace('0x', '').replace('0X', '');\n        var asBn = new BigNumber(address, 16);\n        var base36 = asBn.toString(36);\n        var padded = leftPad(base36, 15);\n        return Iban.fromBban(padded.toUpperCase());\n      }\n    }, {\n      key: \"fromBban\",\n      value: function fromBban(bban) {\n        var countryCode = 'XE';\n        var remainder = module9710(iso13616Prepare(\"\".concat(countryCode, \"00\").concat(bban)));\n        var checkDigit = \"0\".concat(98 - remainder).slice(-2);\n        return new Iban(countryCode + checkDigit + bban);\n      }\n    }, {\n      key: \"createIndirect\",\n      value: function createIndirect(options) {\n        return Iban.fromBban(\"ETH\".concat(options.institution).concat(options.identifier));\n      }\n    }, {\n      key: \"isValid\",\n      value: function isValid(iban) {\n        var i = new Iban(iban);\n        return i.isValid();\n      }\n    }]);\n\n    return Iban;\n  }();\n\n  exports.Iban = Iban;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":null,"metadata":{},"sourceType":"script"}