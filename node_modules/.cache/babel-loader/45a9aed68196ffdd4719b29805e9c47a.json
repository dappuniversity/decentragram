{"ast":null,"code":"'use strict';\n\nvar bs58 = require('bs58');\n\nmodule.exports = {\n  deserialize: function deserialize(data, enc) {\n    enc = enc ? enc.toLowerCase() : 'json';\n\n    if (enc === 'json') {\n      return deserializeFromJson(data);\n    } else if (enc === 'base64') {\n      return deserializeFromBase64(data);\n    }\n\n    throw new Error(\"Unsupported encoding: '\".concat(enc, \"'\"));\n  }\n};\n\nfunction deserializeFromJson(data) {\n  var json = JSON.parse(data);\n  return deserializeFromBase64(json);\n}\n\nfunction deserializeFromBase64(obj) {\n  if (!isPubsubMessage(obj)) {\n    throw new Error(\"Not a pubsub message\");\n  }\n\n  return {\n    from: bs58.encode(Buffer.from(obj.from, 'base64')).toString(),\n    seqno: Buffer.from(obj.seqno, 'base64'),\n    data: Buffer.from(obj.data, 'base64'),\n    topicIDs: obj.topicIDs || obj.topicCIDs\n  };\n}\n\nfunction isPubsubMessage(obj) {\n  return obj && obj.from && obj.seqno && obj.data && (obj.topicIDs || obj.topicCIDs);\n}","map":null,"metadata":{},"sourceType":"script"}